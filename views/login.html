<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>

  <body>
    <h1>Login with Nest</h1>
    <h2>Continue to login with {{ name }}?</h2>
    <p>They'll be able to:</p>
    <ul>
      {% for scope in scopes %}
      {% if scope == "profile" %}<li>View your username, user ID, and the groups you are in</li>{% endif %}
      {% if scope == "email" %}<li>View your real, non-hackclub.app email</li>{% endif %}
      {% endfor %}

    </ul>
    <p>
      <b>{{ developer.name }}</b> provided this description: {{ description }}
    </p>
    <h2>Details about the developer:</h2>
    <p>
      The developer, <b>{{ developer.name }}</b>, has an account on nest with
      the username <b>{{ developer.account }}</b>.
      <a href="{{ developer.website }}">Visit their website</a>.
    </p>
    <p>{% if privacyPolicy %}The developer has also provided a privacy policy. <a href="{{ privacyPolicy }}">You may view it here.</a>{% endif %}</p>
    <h2>Authorize</h2>
    <p>
      To authorize, you must provide your Nest credentials below. It will be
      checked against PAM.
    </p>
    <label for="username">Username</label>
    <form action="/oauth2/validate" method="POST">
      <input
        type="username"
        name="username"
        id="username"
        placeholder="username"
      />
      <label for="password">Password</label>
      <input
        type="password"
        name="password"
        id="password"
        placeholder="●●●●●●●●●●"
      />
      <input
        type="hidden"
        name="state"
        id="state"
        placeholder=""
        value="{{ state }}"
        hidden="true"
      />
      <input
        type="hidden"
        name="redirect_uri"
        id="redirect_uri"
        placeholder=""
        value="{{ redirectURI }}"
        hidden="true"
      />
      <input
        type="hidden"
        name="client_id"
        id="client_id"
        placeholder=""
        value="{{ client_id }}"
        hidden="true"
      />
      <input
        type="hidden"
        name="scope"
        id="scope"
        placeholder=""
        value="{{ scope }}"
        hidden="true"
      />
      <br>
      <h2>Passwordless Authorization</h2>
      <p>Use the command <code>oauth-keygen</code> on Nest to generate a key. Entering anything here will override username/password authentication</p>
      <input
        type="auth_code"
        name="auth_code"
        id="auth_code"
        placeholder="●●●●●●●●●●"
        required="true"
      />
      <br>
      <button type="submit">Authorize</button>
    </form>
  </body>
</html>
